<!DOCTYPE html>
<html lang="pt-br">

<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Gin API | Dashboard do Aluno</title>
    <link href="https://fonts.googleapis.com/css2?family=Outfit:wght@300;400;600;700&display=swap" rel="stylesheet">
    <script src="https://cdn.jsdelivr.net/npm/chart.js"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/html2canvas/1.4.1/html2canvas.min.js"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/jspdf/2.5.1/jspdf.umd.min.js"></script>
    <style>
        /* DEFINI√á√ÉO DE VARI√ÅVEIS CSS (Paleta de cores e efeitos) */
        :root {
            --glass-bg: rgba(255, 255, 255, 0.05);
            /* Cor de fundo transl√∫cida para efeito de vidro */
            --glass-border: rgba(255, 255, 255, 0.1);
            /* Cor da borda sutil e semitransparente */
            --glass-shadow: 0 8px 32px 0 rgba(0, 0, 0, 0.37);
            /* Sombra difusa para dar profundidade */
            --primary: #00f2fe;
            /* Cor prim√°ria: Azul Ciano Neon */
            --secondary: #4facfe;
            /* Cor secund√°ria: Azul Claro */
            --accent: #ff0055;
            /* Cor de destaque: Rosa/Vermelho Vibrante */
            --text-main: #ffffff;
            /* Cor principal do texto: Branco */
            --text-secondary: #a0a0a0;
            /* Cor secund√°ria do texto: Cinza Claro */
        }

        /* Configura√ß√µes globais do corpo da p√°gina (body) */
        body {
            font-family: 'Outfit', sans-serif;
            /* Define a fonte principal como 'Outfit' */
            background: #0f0c29;
            /* Define uma cor de fundo s√≥lida de fallback */
            background: linear-gradient(to right, #24243e, #302b63, #0f0c29);
            /* Define o gradiente de fundo roxo escuro */
            color: var(--text-main);
            /* Define a cor padr√£o do texto usando a vari√°vel */
            min-height: 100vh;
            /* Garante que o corpo ocupe pelo menos 100% da altura da janela */
            margin: 0;
            /* Remove as margens padr√£o do navegador */
            display: flex;
            /* Habilita o modelo Flexbox para layout */
            justify-content: center;
            /* Centraliza o conte√∫do horizontalmente */
            align-items: center;
            /* Centraliza o conte√∫do verticalmente */
            padding: 2rem;
            /* Adiciona preenchimento interno de 2rem em todos os lados */
            overflow-x: hidden;
            /* Impede a rolagem horizontal caso algo exceda a largura */
        }

        /* ELEMENTOS DE FUNDO (Blobs/Manchas coloridas animadas) */
        .blob {
            position: absolute;
            /* Posicionamento absoluto em rela√ß√£o ao corpo da p√°gina */
            filter: blur(80px);
            /* Aplica um desfoque intenso para suavizar as bordas */
            z-index: -1;
            /* Coloca o elemento atr√°s de todo o conte√∫do principal */
            opacity: 0.6;
            /* Define a opacidade para 60% (semitransparente) */
            animation: move 10s infinite alternate;
            /* Aplica a anima√ß√£o 'move' por 10s em loop */
        }

        /* Estilos espec√≠ficos para a primeira mancha */
        .blob-1 {
            background: var(--secondary);
            /* Usa a cor secund√°ria (azul claro) */
            width: 300px;
            /* Largura de 300px */
            height: 300px;
            /* Altura de 300px */
            top: 10%;
            /* Posiciona a 10% do topo da p√°gina */
            left: 10%;
            /* Posiciona a 10% da esquerda da p√°gina */
            border-radius: 40% 60% 70% 30% / 40% 50% 60% 50%;
            /* Bordas irregulares para forma org√¢nica */
        }

        /* Estilos espec√≠ficos para a segunda mancha */
        .blob-2 {
            background: var(--accent);
            /* Usa a cor de destaque (rosa) */
            width: 250px;
            /* Largura de 250px */
            height: 250px;
            /* Altura de 250px */
            bottom: 10%;
            /* Posiciona a 10% da parte inferior */
            right: 10%;
            /* Posiciona a 10% da direita */
            border-radius: 60% 40% 30% 70% / 60% 30% 70% 40%;
            /* Bordas irregulares diferentes */
            animation-delay: -5s;
            /* Come√ßa a anima√ß√£o com atraso negativo para dessincronizar */
        }

        /* Defini√ß√£o da anima√ß√£o 'move' (flutua√ß√£o) */
        @keyframes move {
            from {
                transform: translate(0, 0) rotate(0deg);
                /* Come√ßa na posi√ß√£o original */
            }

            to {
                transform: translate(20px, 40px) rotate(20deg);
                /* Move e rotaciona levemente */
            }
        }

        /* Container principal que organiza o layout */
        .container {
            width: 100%;
            /* Ocupa 100% da largura dispon√≠vel */
            max-width: 1100px;
            /* Limita a largura m√°xima a 1100px */
            display: grid;
            /* Habilita Grid Layout */
            grid-template-columns: 1fr 1.5fr;
            /* Duas colunas: esquerda (1 parte), direita (1.5 partes) */
            gap: 2rem;
            /* Espa√ßamento de 2rem entre as colunas */
            z-index: 1;
            /* Garante que fique acima do fundo (blobs) */
        }

        /* ESTILO DOS PAIN√âIS DE VIDRO (Glassmorphism) */
        .glass-panel {
            background: var(--glass-bg);
            /* Fundo semitransparente */
            backdrop-filter: blur(12px);
            /* Desfoque do fundo atr√°s do painel */
            -webkit-backdrop-filter: blur(12px);
            /* Suporte para Safari */
            border: 1px solid var(--glass-border);
            /* Borda fina e transl√∫cida */
            border-radius: 24px;
            /* Arredonda os cantos do painel */
            padding: 2.5rem;
            /* Espa√ßamento interno generoso */
            box-shadow: var(--glass-shadow);
            /* Sombra suave para eleva√ß√£o */
        }

        /* T√≠tulos H1 (Principal) */
        h1 {
            font-size: 2.5rem;
            /* Tamanho da fonte grande */
            margin-bottom: 0.5rem;
            /* Margem inferior pequena */
            background: linear-gradient(to right, var(--primary), var(--secondary));
            /* Gradiente no texto */
            -webkit-background-clip: text;
            /* Aplica o fundo apenas na √°rea do texto (Webkit) */
            background-clip: text;
            /* Aplica o fundo apenas na √°rea do texto (Padr√£o) */
            -webkit-text-fill-color: transparent;
            /* Torna a cor do texto transparente para mostrar o fundo */
            font-weight: 700;
            /* Peso da fonte em negrito */
        }

        /* T√≠tulos H2 (Secund√°rios) */
        h2 {
            font-size: 1.5rem;
            /* Tamanho m√©dio */
            margin-bottom: 1.5rem;
            /* Margem inferior para separar do conte√∫do */
            color: var(--text-main);
            /* Cor branca padr√£o */
            display: flex;
            /* Flexbox para alinhar itens internos */
            justify-content: space-between;
            /* Espalha o t√≠tulo e o bot√£o de atualizar */
            align-items: center;
            /* Alinha verticalmente */
        }

        /* Subt√≠tulos */
        .subtitle {
            color: var(--text-secondary);
            /* Cor cinza claro */
            margin-bottom: 2rem;
            /* Espa√ßo abaixo do subt√≠tulo */
            font-weight: 300;
            /* Fonte mais fina (light) */
        }

        /* ESTILOS DO FORMUL√ÅRIO */
        .form-group {
            margin-bottom: 1.5rem;
            /* Espa√ßo entre cada grupo de input */
            position: relative;
            /* Posicionamento relativo para elementos filhos */
        }

        /* R√≥tulos dos campos */
        label {
            display: block;
            /* Ocupa a linha inteira */
            margin-bottom: 0.5rem;
            /* Espa√ßo entre r√≥tulo e input */
            font-size: 0.9rem;
            /* Tamanho de fonte levemente menor */
            color: var(--text-secondary);
            /* Cor cinza */
            margin-left: 0.5rem;
            /* Pequeno recuo √† esquerda */
        }

        /* Campos de entrada (Input e Select) globais */
        input,
        select {
            width: 100%;
            /* Largura total do container */
            padding: 14px 18px;
            /* Preenchimento interno confort√°vel */
            background: rgba(0, 0, 0, 0.2);
            /* Fundo preto semitransparente */
            border: 1px solid var(--glass-border);
            /* Borda sutil */
            border-radius: 12px;
            /* Cantos arredondados */
            color: white;
            /* Texto branco */
            font-family: inherit;
            /* Herda a fonte do corpo */
            font-size: 1rem;
            /* Tamanho da fonte padr√£o */
            transition: all 0.3s ease;
            /* Transi√ß√£o suave para efeitos de hover/focus */
            box-sizing: border-box;
            /* Inclui padding e border no c√°lculo da largura */
        }

        /* Estado de foco nos inputs e selects */
        input:focus,
        select:focus {
            outline: none;
            /* Remove a borda padr√£o do navegador */
            border-color: var(--primary);
            /* Muda a cor da borda para ciano */
            background: rgba(0, 0, 0, 0.4);
            /* Escurece o fundo */
            box-shadow: 0 0 15px rgba(79, 172, 254, 0.2);
            /* Adiciona brilho externo (glow) */
        }

        /* Bot√£o Principal (Cadastrar/Buscar) */
        button.btn-main {
            width: 100%;
            /* Largura total */
            padding: 16px;
            /* Altura confort√°vel */
            background: linear-gradient(135deg, var(--secondary), var(--primary));
            /* Gradiente de fundo */
            border: none;
            /* Remove borda */
            border-radius: 12px;
            /* Cantos arredondados */
            color: #000;
            /* Texto preto para contraste */
            font-weight: 700;
            /* Texto em negrito */
            font-size: 1.1rem;
            /* Tamanho da fonte */
            cursor: pointer;
            /* Muda cursor para m√£ozinha */
            transition: transform 0.2s, box-shadow 0.2s;
            /* Anima√ß√µes suaves */
            margin-top: 1rem;
            /* Espa√ßo acima do bot√£o */
        }

        /* Estado Hover do Bot√£o Principal */
        button.btn-main:hover {
            transform: translateY(-3px);
            /* Move o bot√£o levemente para cima */
            box-shadow: 0 5px 20px rgba(79, 172, 254, 0.4);
            /* Sombra com cor neon */
        }

        /* Bot√£o de Atualizar (√≠cone pequeno) */
        button.btn-refresh {
            background: rgba(255, 255, 255, 0.1);
            /* Fundo sutil */
            border: none;
            /* Sem borda */
            color: white;
            /* √çcone branco */
            padding: 8px 16px;
            /* Tamanho menor */
            border-radius: 20px;
            /* Bordas bem arredondadas (p√≠lula) */
            cursor: pointer;
            /* Cursor de clique */
            font-size: 0.9rem;
            /* Fonte menor */
            transition: background 0.2s;
            /* Transi√ß√£o de fundo */
        }

        /* Hover do Bot√£o Atualizar */
        button.btn-refresh:hover {
            background: rgba(255, 255, 255, 0.2);
            /* Clareia o fundo ao passar o mouse */
        }

        /* Bot√£o de Editar (√≠cone l√°pis) */
        button.btn-edit {
            background: rgba(255, 255, 255, 0.1);
            border: none;
            color: var(--primary);
            padding: 8px;
            /* Padding quadrado */
            border-radius: 50%;
            /* C√≠rculo perfeito */
            cursor: pointer;
            font-size: 1rem;
            transition: all 0.2s;
            display: flex;
            /* Centraliza o √≠cone */
            align-items: center;
            justify-content: center;
            width: 32px;
            height: 32px;
            margin-right: 10px;
            /* Espa√ßo para o texto */
        }

        button.btn-edit:hover {
            background: var(--primary);
            /* Fundo preenche com a cor prim√°ria */
            color: #000;
            /* √çcone fica preto */
            transform: scale(1.1);
            /* Aumenta levemente */
        }

        /* Bot√£o Cancelar Edi√ß√£o (Vermelho) */
        button.btn-cancel {
            background: rgba(255, 87, 87, 0.2);
            border: 1px solid rgba(255, 87, 87, 0.5);
            color: #ff5757;
            padding: 10px;
            width: 100%;
            border-radius: 12px;
            margin-top: 10px;
            cursor: pointer;
            font-weight: 600;
            display: none;
            /* Oculto por padr√£o */
            transition: all 0.2s;
        }

        button.btn-cancel:hover {
            background: rgba(255, 87, 87, 0.3);
            transform: translateY(-2px);
        }

        /* Container da Lista de Alunos */
        .list-container {
            max-height: 600px;
            /* Altura m√°xima fixa */
            overflow-y: auto;
            /* Adiciona barra de rolagem se conte√∫do exceder */
            padding-right: 10px;
            /* Espa√ßo para a barra de rolagem n√£o colar no conte√∫do */
        }

        /* Estiliza√ß√£o da Barra de Rolagem (Webkit/Chrome) */
        .list-container::-webkit-scrollbar {
            width: 6px;
            /* Largura fina */
        }

        .list-container::-webkit-scrollbar-thumb {
            background: var(--glass-border);
            /* Cor da barra igual √† borda de vidro */
            border-radius: 3px;
            /* Arredondada */
        }

        /* Card Individual de Aluno */
        .aluno-card {
            background: rgba(255, 255, 255, 0.03);
            /* Fundo muito sutil */
            border: 1px solid var(--glass-border);
            /* Borda fina */
            border-radius: 16px;
            /* Arredondado */
            padding: 1.2rem;
            /* Espa√ßamento interno */
            margin-bottom: 1rem;
            /* Espa√ßo entre cards */
            display: flex;
            /* Flexbox para alinhar avatar e texto */
            align-items: center;
            /* Alinhamento vertical centro */
            transition: all 0.3s;
            /* Transi√ß√£o para hover */
            animation: simpleCheck 0.6s cubic-bezier(0.2, 0.8, 0.2, 1);
            /* Anima√ß√£o de entrada suave */
        }

        /* Hover do Card de Aluno */
        .aluno-card:hover {
            background: rgba(255, 255, 255, 0.08);
            /* Clareia o fundo */
            transform: translateX(5px);
            /* Move levemente para a direita */
            border-color: rgba(255, 255, 255, 0.3);
            /* Borda mais vis√≠vel */
        }

        /* Avatar (C√≠rculo com iniciais) */
        .avatar {
            width: 48px;
            /* Largura fixa */
            height: 48px;
            /* Altura fixa */
            border-radius: 12px;
            /* Quadrado arredondado (squircle) */
            background: linear-gradient(135deg, #FF9A9E 0%, #FECFEF 100%);
            /* Gradiente rosa */
            display: flex;
            /* Flex para centralizar texto */
            align-items: center;
            /* Centro vertical */
            justify-content: center;
            /* Centro horizontal */
            font-weight: bold;
            /* Texto negrito */
            color: #333;
            /* Cor escura para texto nas iniciais */
            margin-right: 1rem;
            /* Espa√ßo √† direita */
            font-size: 1.2rem;
            /* Tamanho da letra */
        }

        /* Informa√ß√µes do Aluno no Card */
        .info h3 {
            margin: 0;
            /* Zera margem */
            font-size: 1.1rem;
            /* Tamanho do nome */
            color: white;
            /* Cor branca */
        }

        .info p {
            margin: 4px 0 0 0;
            /* Pequena margem superior */
            font-size: 0.85rem;
            /* Texto menor para detalhes */
            color: var(--text-secondary);
            /* Cor cinza */
        }

        /* Badge com o ID do Aluno */
        .badge {
            margin-left: auto;
            /* Empurra para o final direito do card */
            background: rgba(79, 172, 254, 0.2);
            /* Fundo azul transl√∫cido */
            color: var(--primary);
            /* Texto azul neon */
            padding: 4px 10px;
            /* Espa√ßamento interno */
            border-radius: 20px;
            /* Formato de p√≠lula */
            font-size: 0.8rem;
            /* Fonte pequena */
            font-weight: 600;
            /* Semi-negrito */
        }

        /* Responsividade para Mobile */
        @media (max-width: 850px) {
            .container {
                grid-template-columns: 1fr;
                /* Muda para uma √∫nica coluna */
            }

            .blob {
                opacity: 0.4;
                /* Reduz a opacidade das manchas para n√£o distrair */
            }
        }

        /* Keyframes da Anima√ß√£o de Entrada dos Cards */
        @keyframes simpleCheck {
            from {
                opacity: 0;
                /* Come√ßa invis√≠vel */
                transform: translateY(10px);
                /* Come√ßa levemente abaixo */
            }

            to {
                opacity: 1;
                /* Termina vis√≠vel */
                transform: translateY(0);
                /* Termina na posi√ß√£o original */
            }
        }
    </style>
</head>

<body>
    <!-- Elementos decorativos de fundo (Manchas/Blobs) -->
    <div class="blob blob-1"></div> <!-- Mancha colorida 1 (Azul) -->
    <div class="blob blob-2"></div> <!-- Mancha colorida 2 (Rosa) -->

    <!-- Container principal que alinha os pain√©is na tela -->
    <div class="container">

        <!-- PAINEL DE FORMUL√ÅRIO / DASHBOARD (Coluna da Esquerda) -->
        <div class="glass-panel">
            <!-- Cabe√ßalho do Painel -->
            <h1>Gin API</h1> <!-- T√≠tulo principal com gradiente -->

            <!-- Bot√µes de Altern√¢ncia de Visualiza√ß√£o -->
            <div style="display: flex; gap: 10px; margin-bottom: 20px;">
                <button onclick="toggleView('form')" id="btn-view-form" class="btn-main"
                    style="margin-top: 0; background: var(--glass-bg); border: 1px solid var(--glass-border);">üìù
                    Formul√°rio</button>
                <button onclick="toggleView('dashboard')" id="btn-view-dashboard" class="btn-main"
                    style="margin-top: 0; background: transparent; border: 1px solid var(--glass-border); opacity: 0.7;">üìä
                    Dashboard</button>
            </div>

            <!-- CONTAINER DO FORMUL√ÅRIO -->
            <div id="form-container">
                <p class="subtitle">Gerencie seus alunos com estilo.</p> <!-- Subt√≠tulo descritivo -->

                <!-- Formul√°rio de Cadastro de Alunos -->
                <form id="form-aluno">
                    <h2>Novo Cadastro</h2> <!-- T√≠tulo da se√ß√£o de formul√°rio -->

                    <!-- Campo: Nome Completo -->
                    <div class="form-group">
                        <label for="nome">Nome Completo</label> <!-- R√≥tulo acess√≠vel -->
                        <input type="text" id="nome" placeholder="John Doe" required>
                        <!-- Input de texto obrigat√≥rio -->
                    </div>

                    <!-- Campo: CPF -->
                    <div class="form-group">
                        <label for="cpf">CPF</label> <!-- R√≥tulo -->
                        <input type="text" id="cpf" placeholder="000.000.000-00" maxlength="14" required>
                        <!-- Input com limite de caracteres para m√°scara -->
                    </div>

                    <!-- Campo: RG -->
                    <div class="form-group">
                        <label for="rg">RG</label> <!-- R√≥tulo -->
                        <input type="text" id="rg" placeholder="00.000.000-0" maxlength="12" required>
                        <!-- Input com limite de caracteres -->
                    </div>

                    <!-- Grid interno para campos menores (Idade e Sexo) lado a lado -->
                    <div style="display: grid; grid-template-columns: 1fr 1fr; gap: 1rem;">

                        <!-- Campo: Idade -->
                        <div class="form-group">
                            <label for="idade">Idade</label> <!-- R√≥tulo -->
                            <select id="idade" required> <!-- Dropdown de sele√ß√£o obrigat√≥rio -->
                                <option value="" disabled selected>Selecione</option> <!-- Op√ß√£o padr√£o desabilitada -->
                                <!-- As op√ß√µes de 1 a 100 ser√£o preenchidas via JavaScript -->
                            </select>
                        </div>

                        <!-- Campo: Sexo -->
                        <div class="form-group">
                            <label for="sexo">Sexo</label> <!-- R√≥tulo -->
                            <select id="sexo" required> <!-- Dropdown de sele√ß√£o obrigat√≥rio -->
                                <option value="Masculino">Masculino</option> <!-- Op√ß√£o Masculino -->
                                <option value="Feminino">Feminino</option> <!-- Op√ß√£o Feminino -->
                            </select>
                        </div>
                    </div>

                    <!-- Bot√£o de Envio do Formul√°rio -->
                    <button type="submit" class="btn-main" id="btn-submit">Cadastrar Aluno ‚ú®</button>

                    <!-- Bot√£o cancelar edi√ß√£o (aparece s√≥ quando est√° editando) -->
                    <button type="button" onclick="cancelarEdicao()" class="btn-cancel" id="btn-cancel">Cancelar Edi√ß√£o
                        ‚ùå</button>
                </form>
            </div>

            <!-- CONTAINER DO DASHBOARD (Gr√°ficos) - Inicialmente Oculto -->
            <div id="dashboard-container" style="display: none;">
                <p class="subtitle">Estat√≠sticas em tempo real.</p>

                <!-- Gr√°fico 1: Distribui√ß√£o por G√™nero -->
                <div style="margin-bottom: 30px; background: rgba(0,0,0,0.2); padding: 15px; border-radius: 16px;">
                    <h3 style="margin-top: 0; font-size: 1rem; color: var(--secondary);">G√™nero</h3>
                    <div style="height: 200px; display: flex; justify-content: center;">
                        <canvas id="chart-gender"></canvas>
                    </div>
                </div>

                <!-- Gr√°fico 2: Distribui√ß√£o por Idade -->
                <div style="background: rgba(0,0,0,0.2); padding: 15px; border-radius: 16px;">
                    <h3 style="margin-top: 0; font-size: 1rem; color: var(--secondary);">Faixa Et√°ria</h3>
                    <div style="height: 200px;">
                        <canvas id="chart-age"></canvas>
                    </div>
                </div>
            </div>
        </div>

        <!-- PAINEL DE LISTAGEM (Coluna da Direita) -->
        <div class="glass-panel">
            <!-- Cabe√ßalho da Lista com Bot√£o de Atualizar -->
            <h2>
                Lista de Alunos
                <!-- Bot√£o para recarregar a lista manualmente -->
                <button onclick="listarAlunos()" class="btn-refresh">üîÑ Atualizar</button>
            </h2>

            <!-- SE√á√ÉO DE FILTROS -->
            <div
                style="background: rgba(0,0,0,0.2); padding: 15px; border-radius: 16px; margin-bottom: 20px; border: 1px solid var(--glass-border);">
                <h3 style="margin: 0 0 10px 0; font-size: 1rem; color: var(--secondary);">Filtrar Alunos</h3>

                <div style="display: grid; grid-template-columns: 1fr 1fr; gap: 10px; margin-bottom: 10px;">
                    <!-- Filtro por Nome -->
                    <input type="text" id="filter-nome" placeholder="Nome..." style="font-size: 0.9rem; padding: 10px;">

                    <!-- Filtro por CPF -->
                    <input type="text" id="filter-cpf" placeholder="CPF (apenas n√∫meros)"
                        style="font-size: 0.9rem; padding: 10px;">
                </div>

                <div style="display: flex; gap: 10px;">
                    <!-- Bot√£o de Filtrar -->
                    <button onclick="listarAlunos()" class="btn-main"
                        style="margin-top: 0; padding: 10px; font-size: 1rem;">üîé Filtrar</button>

                    <!-- Bot√£o de Limpar Filtros -->
                    <button onclick="limparFiltros()"
                        style="background: rgba(255,255,255,0.1); border: 1px solid rgba(255,255,255,0.2); color: white; border-radius: 12px; cursor: pointer; padding: 0 15px;">Limpar</button>
                </div>
            </div>

            <!-- BUSCA POR ID (ANTIGA, MANTIDA COMO OP√á√ÉO SECUND√ÅRIA) -->
            <div
                style="display: flex; gap: 10px; margin-bottom: 20px; align-items: center; border-top: 1px solid rgba(255,255,255,0.1); padding-top: 15px;">
                <span style="font-size: 0.8rem; color: var(--text-secondary); white-space: nowrap;">Ou busque por
                    ID:</span>
                <!-- Input de busca por ID num√©rico -->
                <input type="number" id="search-id" placeholder="ID..." style="margin-bottom: 0; padding: 8px;">

                <!-- Bot√£o de a√ß√£o de busca -->
                <button onclick="buscarAluno()" class="btn-main"
                    style="width: auto; margin-top: 0; white-space: nowrap; padding: 8px 15px; font-size: 0.9rem;">Ir</button>
            </div>

            <!-- Container onde os cards de alunos ser√£o injetados -->
            <div id="lista-alunos" class="list-container">
                <!-- Conte√∫do inicial de carregamento ou lista vazia -->
                <!-- Os itens reais ser√£o inseridos aqui pela fun√ß√£o listarAlunos() no JavaScript -->
                <p style="text-align: center; margin-top: 2rem; color: rgba(255,255,255,0.3);">Carregando dados...</p>
            </div>

            <!-- PAGINA√á√ÉO -->
            <div id="pagination"
                style="display: none; justify-content: center; gap: 15px; margin-top: 20px; align-items: center; padding-top: 15px; border-top: 1px solid rgba(255,255,255,0.1);">
                <button onclick="mudarPagina(-1)" id="btn-prev" class="btn-main"
                    style="width: auto; margin: 0; padding: 8px 15px; font-size: 0.9rem;">‚óÄ Anterior</button>
                <span id="page-indicator" style="color: var(--text-secondary); font-size: 0.9rem;">P√°gina 1</span>
                <button onclick="mudarPagina(1)" id="btn-next" class="btn-main"
                    style="width: auto; margin: 0; padding: 8px 15px; font-size: 0.9rem;">Pr√≥ximo ‚ñ∂</button>
            </div>

            <!-- TEMPLATE DA CARTEIRINHA (Oculto, usado para gera√ß√£o de imagem) -->
            <div id="id-card-template" style="
                position: absolute; 
                top: -9999px; 
                width: 400px; 
                height: 250px; 
                background: linear-gradient(135deg, #0f0c29, #302b63, #24243e); 
                border-radius: 16px; 
                display: flex; 
                flex-direction: column; 
                padding: 20px; 
                box-sizing: border-box; 
                border: 2px solid rgba(255,255,255,0.2); 
                font-family: 'Outfit', sans-serif;
                color: white;
                overflow: hidden;">

                <!-- Background decorativo -->
                <div
                    style="position: absolute; top: 0; right: 0; width: 150px; height: 150px; background: rgba(0, 242, 254, 0.2); border-radius: 50%; filter: blur(40px);">
                </div>
                <div
                    style="position: absolute; bottom: 0; left: 0; width: 100px; height: 100px; background: rgba(255, 0, 85, 0.2); border-radius: 50%; filter: blur(30px);">
                </div>

                <!-- Header -->
                <div
                    style="display: flex; justify-content: space-between; align-items: center; margin-bottom: 20px; z-index: 2;">
                    <div
                        style="font-weight: 700; font-size: 1.2rem; background: linear-gradient(to right, #00f2fe, #4facfe); -webkit-background-clip: text; -webkit-text-fill-color: transparent;">
                        GIN ACADEMY</div>
                    <div
                        style="font-size: 0.7rem; opacity: 0.7; border: 1px solid rgba(255,255,255,0.3); padding: 2px 8px; border-radius: 10px;">
                        ESTUDANTE</div>
                </div>

                <!-- Conte√∫do Principal -->
                <div style="display: flex; gap: 20px; z-index: 2;">
                    <!-- Foto Fake (Iniciais) -->
                    <div id="card-avatar" style="
                        width: 80px; 
                        height: 80px; 
                        background: linear-gradient(135deg, #FF9A9E, #FECFEF); 
                        border-radius: 12px; 
                        display: flex; 
                        justify-content: center; 
                        align-items: center; 
                        font-size: 2rem; 
                        font-weight: bold; 
                        color: #333;
                        box-shadow: 0 4px 15px rgba(0,0,0,0.3);">
                        --
                    </div>

                    <!-- Dados -->
                    <div style="display: flex; flex-direction: column; justify-content: center;">
                        <div style="font-size: 0.7rem; color: #aaa; text-transform: uppercase;">Nome do Aluno</div>
                        <div id="card-nome" style="font-size: 1.1rem; font-weight: 600; margin-bottom: 8px;">Nome
                            Completo</div>

                        <div style="font-size: 0.7rem; color: #aaa; text-transform: uppercase;">CPF</div>
                        <div id="card-cpf" style="font-size: 0.9rem; letter-spacing: 1px;">000.000.000-00</div>
                    </div>
                </div>

                <!-- Footer -->
                <div
                    style="margin-top: auto; display: flex; justify-content: space-between; align-items: flex-end; z-index: 2;">
                    <div>
                        <div style="font-size: 0.6rem; color: #777;">V√°lido at√©</div>
                        <div style="font-size: 0.8rem;">12/2026</div>
                    </div>
                    <div style="text-align: right;">
                        <div style="font-size: 0.6rem; color: #777;">ID M√°tricula</div>
                        <div id="card-id" style="font-size: 1.2rem; font-family: monospace; color: #00f2fe;">#000</div>
                    </div>
                </div>
            </div>
        </div>
    </div>

    <script>
        // Define a URL base da API (backend em Go)
        const API_URL = 'http://localhost:8080/alunos';

        // Vari√°vel de estado para controlar se estamos editando um aluno (chaves o ID) ou criando novo (null)
        let editingID = null;

        // Vari√°veis globais dos gr√°ficos
        let genderChart = null;
        let ageChart = null;

        // FUN√á√ÉO TOGGLE VIEW: Alterna entre Formul√°rio e Dashboard
        function toggleView(view) {
            const formContainer = document.getElementById('form-container');
            const dashboardContainer = document.getElementById('dashboard-container');
            const btnForm = document.getElementById('btn-view-form');
            const btnDash = document.getElementById('btn-view-dashboard');

            if (view === 'form') {
                formContainer.style.display = 'block';
                dashboardContainer.style.display = 'none';

                // Estilo ativo/inativo
                btnForm.style.opacity = '1';
                btnForm.style.background = 'var(--glass-bg)';
                btnDash.style.opacity = '0.7';
                btnDash.style.background = 'transparent';
            } else {
                formContainer.style.display = 'none';
                dashboardContainer.style.display = 'block';

                btnForm.style.opacity = '0.7';
                btnForm.style.background = 'transparent';
                btnDash.style.opacity = '1';
                btnDash.style.background = 'var(--glass-bg)';

                // For√ßa atualiza√ß√£o dos gr√°ficos ao entrar na view
                listarAlunos();
            }
        }

        // FUN√á√ÉO DE BUSCA: Procura um aluno espec√≠fico pelo ID
        async function buscarAluno() {
            // Obt√©m o valor digitado no campo de input de busca
            const id = document.getElementById('search-id').value;

            // Valida√ß√£o: Se o campo estiver vazio, exibe alerta e para a execu√ß√£o
            if (!id) return alert("Digite um ID para buscar!");

            try {
                // Faz a requisi√ß√£o HTTP GET para a API passando o ID na URL
                const response = await fetch(`${API_URL}/${id}`);

                // Verifica se o status da resposta √© 404 (N√£o Encontrado)
                if (response.status === 404) {
                    // Exibe a mensagem espec√≠fica solicitada caso o aluno n√£o exista
                    alert("aluno nao cadastrado, por favor verifique o cadastro");
                    return; // Encerra a fun√ß√£o
                }

                // Se a resposta n√£o for OK (200-299) e n√£o for 404, lan√ßa um erro gen√©rico
                if (!response.ok) throw new Error("Erro na busca");

                // Converte a resposta da API (JSON) para um objeto JavaScript
                const aluno = await response.json();

                // Seleciona o container da lista para exibir o resultado
                const listaDiv = document.getElementById('lista-alunos');

                // Extrai as duas primeiras letras do nome para usar como avatar (iniciais)
                const initials = aluno.nome.substring(0, 2).toUpperCase();

                // Sobrescreve o conte√∫do da lista com o card do aluno encontrado
                // Nota: Usa um estilo inline especial para destacar o resultado da busca
                listaDiv.innerHTML = `
                    <div class="aluno-card" style="border-color: var(--primary); background: rgba(0, 242, 254, 0.1);">
                        <div class="avatar">${initials}</div>
                        <div class="info">
                            <h3>${aluno.nome}</h3>
                            <p>${aluno.cpf} ‚Ä¢ ${aluno.idade} anos</p>
                        </div>
                        <span class="badge">#${aluno.ID}</span>
                    </div>
                    <!-- Bot√£o para limpar a busca e voltar a exibir todos os alunos -->
                    <button onclick="listarAlunos()" style="background:none; border:none; color: var(--text-secondary); cursor: pointer; text-decoration: underline; width: 100%; margin-top: 10px;">Voltar para lista completa</button>
                `;

            } catch (error) {
                // Captura erros de rede ou processamento e exibe alerta ao usu√°rio
                alert("Erro ao buscar aluno.");
                console.error(error); // Loga o erro no console para debug
            }
        }

        // SELE√á√ÉO DE ELEMENTOS DE INPUT PARA M√ÅSCARAS
        const cpfInput = document.getElementById('cpf'); // Input do CPF
        const rgInput = document.getElementById('rg');   // Input do RG

        // ADICIONA EVENT LISTENER PARA INPUT DO CPF (M√°scara enquanto digita)
        cpfInput.addEventListener('input', (e) => {
            let value = e.target.value.replace(/\D/g, ''); // Remove tudo que n√£o for d√≠gito
            if (value.length > 11) value = value.slice(0, 11); // Limita a 11 d√≠gitos

            // Aplica a formata√ß√£o 000.000.000-00 usando Regex
            value = value.replace(/(\d{3})(\d)/, '$1.$2'); // Coloca o primeiro ponto
            value = value.replace(/(\d{3})(\d)/, '$1.$2'); // Coloca o segundo ponto
            value = value.replace(/(\d{3})(\d{1,2})$/, '$1-$2'); // Coloca o tra√ßo no final

            // Atualiza o valor do campo com a m√°scara aplicada
            e.target.value = value;
        });

        // ADICIONA EVENT LISTENER PARA INPUT DO RG (M√°scara enquanto digita)
        rgInput.addEventListener('input', (e) => {
            let value = e.target.value.replace(/\D/g, ''); // Remove tudo que n√£o for d√≠gito
            if (value.length > 9) value = value.slice(0, 9); // Limita a 9 d√≠gitos (exemplo padr√£o SP)

            // Aplica a formata√ß√£o 00.000.000-0 usando Regex
            value = value.replace(/(\d{2})(\d)/, '$1.$2'); // Coloca o primeiro ponto
            value = value.replace(/(\d{3})(\d)/, '$1.$2'); // Coloca o segundo ponto
            value = value.replace(/(\d{3})(\d{1})$/, '$1-$2'); // Coloca o tra√ßo no final

            // Atualiza o valor do campo com a m√°scara aplicada
            e.target.value = value;
        });

        // POPULA O SELECT DE IDADE (Gera op√ß√µes de 1 a 100 anos automaticamente)
        const selectIdade = document.getElementById('idade'); // Seleciona o elemento select
        for (let i = 1; i <= 100; i++) {
            const opt = document.createElement('option'); // Cria um novo elemento <option>
            opt.value = i; // Define o valor (ex: 1)
            opt.innerText = i; // Define o texto vis√≠vel (ex: 1)
            selectIdade.appendChild(opt); // Adiciona a op√ß√£o ao select
        }

        // PREPARAR EDI√á√ÉO: Preenche o formul√°rio com os dados do aluno selecionado
        function prepararEdicao(aluno) {
            // Define o ID global que estamos editando
            editingID = aluno.ID;

            // Preenche os campos do formul√°rio
            document.getElementById('nome').value = aluno.nome;
            // Precisamos formatar CPF e RG novamente pois no banco podem estar limpos ou sujos dependendo da implementa√ß√£o,
            // mas aqui assumimos formatar para visualiza√ß√£o
            document.getElementById('cpf').value = aluno.cpf;
            document.getElementById('rg').value = aluno.rg;
            document.getElementById('idade').value = aluno.idade;
            document.getElementById('sexo').value = aluno.sexo; // Assume que valor 'Masculino'/'Feminino' bate com as options

            // Altera visualmente o formul√°rio para modo edi√ß√£o
            const btnSubmit = document.getElementById('btn-submit');
            btnSubmit.innerText = "Salvar Altera√ß√µes üíæ";
            btnSubmit.style.background = "linear-gradient(135deg, #ff9966, #ff5e62)"; // Laranja para indicar edi√ß√£o

            document.getElementById('btn-cancel').style.display = 'block'; // Mostra bot√£o cancelar

            // Rola suavemente at√© o formul√°rio
            document.querySelector('.container').scrollIntoView({ behavior: 'smooth' });
        }

        // CANCELAR EDI√á√ÉO: Limpa o estado e volta ao modo de cadastro
        function cancelarEdicao() {
            editingID = null; // Limpa o ID
            document.getElementById('form-aluno').reset(); // Limpa inputs

            // Restaura bot√£o de submit
            const btnSubmit = document.getElementById('btn-submit');
            btnSubmit.innerText = "Cadastrar Aluno ‚ú®";
            btnSubmit.style.background = ""; // Volta ao CSS original

            document.getElementById('btn-cancel').style.display = 'none'; // Esconde bot√£o cancelar
        }

        // LIMPAR FILTROS: Reseta os campos de busca e recarrega a lista completa
        function limparFiltros() {
            document.getElementById('filter-nome').value = '';
            document.getElementById('filter-cpf').value = '';
            listarAlunos();
        }

        // FUN√á√ÉO DELETAR ALUNO: Remove um aluno do banco de dados
        async function deletarAluno(id, nome) {
            // Confirma√ß√£o simples com o usu√°rio
            if (!confirm(`Tem certeza que deseja deletar o aluno(a) ${nome}?`)) return;

            try {
                // Envia requisi√ß√£o DELETE para a API
                const res = await fetch(`${API_URL}/${id}`, {
                    method: 'DELETE'
                });

                if (res.ok) {
                    alert("Aluno deletado com sucesso!");
                    listarAlunos(); // Atualiza a lista

                    // Se estivermos editando este mesmo aluno, limpa o formul√°rio
                    if (editingID === id) cancelarEdicao();
                } else {
                    const error = await res.json();
                    alert("Erro ao deletar: " + (error.error || "Erro desconhecido"));
                }
            } catch (err) {
                alert("Erro de conex√£o ao tentar deletar.");
                console.error(err);
            }
        }

        // Vari√°veis de Pagina√ß√£o
        let currentPage = 1;
        const itemsPerPage = 5; // Limite por p√°gina

        // FUN√á√ÉO LISTAR ALUNOS: Busca e renderiza todos os alunos cadastrados com pagina√ß√£o
        async function listarAlunos(page = 1) {
            const listaDiv = document.getElementById('lista-alunos'); // Container da lista
            const paginationDiv = document.getElementById('pagination');

            // Atualiza estado da p√°gina atual
            currentPage = page;

            // Captura valores dos filtros
            const nomeStr = document.getElementById('filter-nome')?.value || '';
            const cpfStr = document.getElementById('filter-cpf')?.value || '';

            const params = new URLSearchParams();
            if (nomeStr) params.append('nome', nomeStr);
            if (cpfStr) params.append('cpf', cpfStr);

            // Adiciona par√¢metros de pagina√ß√£o
            params.append('page', currentPage);
            params.append('limit', itemsPerPage);

            const url = params.toString() ? `${API_URL}?${params.toString()}` : API_URL;

            try {
                // Faz a requisi√ß√£o GET
                const response = await fetch(url);

                // Verifica se a conex√£o falhou
                if (!response.ok) throw new Error('Falha ao conectar');

                // Converte a resposta para JSON
                // AGORA A RESPOSTA √â UM OBJETO: { data: [...], total: X, page: Y, totalPages: Z }
                const result = await response.json();

                // Fallback para garantir que 'alunos' seja um array (caso a API antiga ainda estivesse rodando)
                const alunos = Array.isArray(result) ? result : (result.data || []);
                const totalPages = result.totalPages || 1;

                listaDiv.innerHTML = ''; // Limpa o conte√∫do atual da lista antes de adicionar novos

                // Verifica se a lista retornada est√° vazia
                if (alunos.length === 0) {
                    listaDiv.innerHTML = '<p style="text-align:center; margin-top: 2rem; color: rgba(255,255,255,0.3);">Nenhum aluno encontrado.</p>';
                    // Mesmo vazia, atualiza gr√°ficos (zerados)
                    updateCharts([]);
                    atualizarPaginacao(0, 0);
                    return;
                }

                // Atualiza os gr√°ficos com os novos dados
                updateCharts(alunos);

                // Itera sobre cada aluno retornado para criar seu card
                alunos.forEach(aluno => {
                    // Gera as iniciais para o avatar
                    const initials = aluno.nome.substring(0, 2).toUpperCase();

                    // Prepara o objeto aluno como string para passar na fun√ß√£o onclick
                    const alunoString = JSON.stringify(aluno).replace(/"/g, '&quot;');

                    // Adiciona o HTML do card ao container da lista (append)
                    listaDiv.innerHTML += `
                        <div class="aluno-card">
                            <div class="avatar">${initials}</div>
                            <div class="info">
                                <h3>${aluno.nome}</h3>
                                <p>${aluno.cpf} ‚Ä¢ ${aluno.idade} anos</p>
                            </div>
                            <!-- Bot√£o de Editar -->
                            <button onclick="prepararEdicao(${alunoString})" class="btn-edit" title="Editar este aluno">‚úèÔ∏è</button>
                            
                            <!-- Bot√£o de Deletar -->
                            <button onclick="deletarAluno(${aluno.ID}, '${aluno.nome}')" class="btn-edit" style="color: #ff5757; margin-right: 0;" title="Deletar este aluno">üóëÔ∏è</button>
                            
                            <!-- Bot√£o de Carteirinha (NOVO) -->
                            <button onclick='gerarCarteirinha(${alunoString})' class="btn-edit" style="color: #fff; margin-left:10px;" title="Baixar Carteirinha">ü™™</button>

                            <span class="badge">#${aluno.ID}</span>
                        </div>
                    `;
                });

                // Atualiza os controles de pagina√ß√£o
                atualizarPaginacao(totalPages);

            } catch (error) {
                // Tratamento de erro de conex√£o (ex: servidor desligado)
                listaDiv.innerHTML = `<p style="text-align: center; color: #ff6b6b; margin-top:2rem;">Erro de conex√£o com API.<br>Verifique se o servidor Go est√° rodando.</p>`;
                console.error(error);
            }
        }

        // FUN√á√ÉO ATUALIZAR PAGINA√á√ÉO: Controla estado dos bot√µes
        function atualizarPaginacao(totalPages) {
            const btnPrev = document.getElementById('btn-prev');
            const btnNext = document.getElementById('btn-next');
            const indicator = document.getElementById('page-indicator');
            const paginationDiv = document.getElementById('pagination');

            if (totalPages <= 1) {
                paginationDiv.style.display = 'none'; // Esconde se s√≥ tiver 1 p√°gina
                return;
            } else {
                paginationDiv.style.display = 'flex';
            }

            indicator.innerText = `P√°gina ${currentPage} de ${totalPages}`;

            // Desabilita "Anterior" se estiver na primeira
            btnPrev.disabled = currentPage === 1;
            btnPrev.style.opacity = currentPage === 1 ? '0.5' : '1';

            // Desabilita "Pr√≥ximo" se estiver na √∫ltima
            btnNext.disabled = currentPage === totalPages;
            btnNext.style.opacity = currentPage === totalPages ? '0.5' : '1';
        }

        // FUN√á√ÉO MUDAR P√ÅGINA: Chamada pelos bot√µes
        function mudarPagina(delta) {
            const novaPagina = currentPage + delta;
            if (novaPagina > 0) {
                listarAlunos(novaPagina);
            }
        }

        // EVENTO DE CADASTRO: Intercepta o envio do formul√°rio para salvar via AJAX
        document.getElementById('form-aluno').addEventListener('submit', async (e) => {
            e.preventDefault(); // Impede o recarregamento padr√£o da p√°gina (submit tradicional)

            // Limpa formata√ß√£o (pontos e tra√ßos) do CPF e RG para enviar apenas n√∫meros limpos ao backend
            const rawCPF = cpfInput.value.replace(/\D/g, '');
            const rawRG = rgInput.value.replace(/\D/g, '');

            // Valida√ß√£o simples de tamanho do CPF no frontend
            if (rawCPF.length !== 11) return alert("CPF Inv√°lido (requer 11 n√∫meros)");

            // Monta o objeto com os dados do novo aluno para enviar
            const aluno = {
                nome: document.getElementById('nome').value, // Pega valor do nome
                cpf: rawCPF, // Usa o CPF limpo
                rg: rawRG,   // Usa o RG limpo
                idade: parseInt(document.getElementById('idade').value), // Converte idade para Inteiro
                sexo: document.getElementById('sexo').value // Pega valor do sexo
            };

            // Define se vamos criar (POST) ou editar (PATCH)
            const method = editingID ? 'PATCH' : 'POST';
            // Se estiver editando, adiciona o ID na URL
            const url = editingID ? `${API_URL}/${editingID}` : API_URL;

            try {
                // Envia requisi√ß√£o para a API
                const res = await fetch(url, {
                    method: method,
                    headers: { 'Content-Type': 'application/json' }, // Define cabe√ßalho JSON
                    body: JSON.stringify(aluno) // Converte objeto JS para string JSON
                });

                // Verifica se o cadastro foi bem-sucedido (Status 2xx)
                if (res.ok) {
                    // Feedback visual de sucesso: altera temporariamente o texto e cor do bot√£o
                    const btn = document.querySelector('.btn-main'); // Seleciona o bot√£o
                    const originalText = btn.innerText; // Guarda o texto original

                    btn.innerText = "Sucesso! üéâ"; // Muda o texto
                    btn.style.background = "linear-gradient(135deg, #11998e, #38ef7d)"; // Muda cor para verde

                    // Se estiver editando, usa a fun√ß√£o de cancelar para limpar estado corretamente
                    if (editingID) {
                        cancelarEdicao();
                    } else {
                        document.getElementById('form-aluno').reset();
                    }
                    listarAlunos(); // Atualiza a lista lateral para mostrar o novo aluno

                    // Restaura o bot√£o ao estado padr√£o ap√≥s 2 segundos
                    setTimeout(() => {
                        btn.innerText = "Cadastrar Aluno ‚ú®";
                        btn.style.background = ""; // Remove estilo inline para voltar ao CSS
                    }, 2000);
                } else {
                    // Alerta gen√©rico se a API retornar erro (ex: 400 ou 500)
                    alert("Erro ao salvar. Verifique o console.");
                }
            } catch (err) {
                // Captura erro de rede
                alert("Erro de conex√£o.");
            }
        });

        // Inicializa a lista de alunos assim que a p√°gina carrega
        listarAlunos();

        // FUN√á√ÉO UPDATE CHARTS: Calcula estat√≠sticas e renderiza gr√°ficos
        function updateCharts(alunos) {
            // Se os graficos j√° existem, destroi para recriar (evita sobreposi√ß√£o)
            if (genderChart) genderChart.destroy();
            if (ageChart) ageChart.destroy();

            // 1. Processamento de Dados G√™nero
            const totalMasculino = alunos.filter(a => a.sexo === 'Masculino').length;
            const totalFeminino = alunos.filter(a => a.sexo === 'Feminino').length;

            // 2. Processamento de Dados Idade (Agrupamento)
            const faixas = { '0-18': 0, '19-30': 0, '31-50': 0, '51+': 0 };
            alunos.forEach(a => {
                if (a.idade <= 18) faixas['0-18']++;
                else if (a.idade <= 30) faixas['19-30']++;
                else if (a.idade <= 50) faixas['31-50']++;
                else faixas['51+']++;
            });

            // Configura√ß√£o comum (Cores e Fontes)
            Chart.defaults.color = '#fff';
            Chart.defaults.font.family = 'Outfit';

            // GR√ÅFICO DE G√äNERO (Doughnut)
            const ctxGender = document.getElementById('chart-gender').getContext('2d');
            genderChart = new Chart(ctxGender, {
                type: 'doughnut',
                data: {
                    labels: ['Masculino', 'Feminino'],
                    datasets: [{
                        data: [totalMasculino, totalFeminino],
                        backgroundColor: ['#4facfe', '#ff0055'], // Cores do tema (Azul e Rosa)
                        borderWidth: 0
                    }]
                },
                options: {
                    responsive: true,
                    maintainAspectRatio: false,
                    plugins: {
                        legend: { position: 'bottom' }
                    }
                }
            });

            // GR√ÅFICO DE IDADE (Bar)
            const ctxAge = document.getElementById('chart-age').getContext('2d');
            ageChart = new Chart(ctxAge, {
                type: 'bar',
                data: {
                    labels: Object.keys(faixas),
                    datasets: [{
                        label: 'Alunos',
                        data: Object.values(faixas),
                        backgroundColor: 'rgba(0, 242, 254, 0.5)', // Cor prim√°ria transl√∫cida
                        borderColor: '#00f2fe',
                        borderWidth: 1,
                        borderRadius: 4
                    }]
                },
                options: {
                    responsive: true,
                    maintainAspectRatio: false,
                    scales: {
                        y: { beginAtZero: true, grid: { color: 'rgba(255,255,255,0.1)' } },
                        x: { grid: { display: false } }
                    },
                    plugins: {
                        legend: { display: false }
                    }
                }
            });
        }

        // FUN√á√ÉO GERAR CARTEIRINHA: Cria um PDF/PNG do card do aluno e baixa
        async function gerarCarteirinha(alunoString) {
            // Parseia o objeto se vier como string (do onclick)
            const aluno = typeof alunoString === 'string' ? JSON.parse(alunoString) : alunoString;

            // Preenche o Template Oculto
            const template = document.getElementById('id-card-template');
            document.getElementById('card-nome').innerText = aluno.nome;
            document.getElementById('card-cpf').innerText = aluno.cpf;
            document.getElementById('card-id').innerText = '#' + aluno.ID;

            // Avatar Fake
            const initials = aluno.nome.substring(0, 2).toUpperCase();
            document.getElementById('card-avatar').innerText = initials;

            // Move temporariamente o template para a tela (vis√≠vel) mas fora da vis√£o do usu√°rio
            // Isso √© necess√°rio porque o html2canvas falha se o elemento tiver "display: none"
            template.style.top = "0";
            template.style.left = "-9999px";
            template.style.display = "flex"; // Garante que √© renderizado

            try {
                // Gera o Canvas a partir do HTML
                const canvas = await html2canvas(template, {
                    scale: 2, // Melhora a resolu√ß√£o (Retina)
                    backgroundColor: null, // Transparente
                    logging: false
                });

                // Cria o PDF
                const { jsPDF } = window.jspdf;
                const pdf = new jsPDF({
                    orientation: 'landscape',
                    unit: 'px',
                    format: [420, 270] // Tamanho um pouco maior que o card (400x250)
                });

                // Adiciona a imagem ao PDF
                const imgData = canvas.toDataURL('image/png');
                pdf.addImage(imgData, 'PNG', 10, 10, 400, 250);

                // Salva o arquivo
                pdf.save(`Carteirinha-${aluno.nome}.pdf`);

            } catch (err) {
                console.error("Erro ao gerar carteirinha:", err);
                alert("Erro ao gerar carteirinha.");
            } finally {
                // Esconde o template novamente
                template.style.top = "-9999px";
            }
        }

    </script>
</body>

</html>